[supervisord]
    logfile=/etc/supervisor/logs/supervisord.log
    logfile_maxbytes=5MB
    logfile_backups=10
    loglevel=info
    pidfile=/tmp/supervisord.pid
    user=root
    nodaemon=false
    minfds=1024
    minprocs=200
[rpcinterface:supervisor]
    supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface
[supervisorctl]
    serverurl=unix:///tmp/supervisor.sock
[program:queue-worker]
    process_name=%(program_name)s_%(process_num)02d
    command=php /var/www/html/artisan queue:work
    autostart=%(ENV_QUEUE_WORKER_ONSTART)s
    autorestart=%(ENV_QUEUE_WORKER_RESTART)s
    stopasgroup=true
    killasgroup=true
    user=supervisoruser
    numprocs=1
    redirect_stderr=true
    stdout_logfile=/var/www/html/storage/logs/worker.log
    stopwaitsecs=3600
    stdout_logfile_maxbytes=5MB
[program:schedule-worker]
    process_name=%(program_name)s_%(process_num)02d
    command=/bin/bash -c "while [ true ]; do (php /var/www/html/artisan schedule:run --verbose --no-interaction &); sleep 60; done"
    autostart=%(ENV_SCHEDULE_WORKER_ONSTART)s
    autorestart=%(ENV_SCHEDULE_WORKER_RESTART)s
    user=supervisoruser
    numprocs=1
    redirect_stderr=true
    stdout_logfile=/var/www/html/storage/logs/schedule.log
    stopwaitsecs=60
[program:horizon]
    process_name=%(program_name)s_%(process_num)02d
    command=php /var/www/html/artisan horizon
    autostart=%(ENV_HORIZON_ONSTART)s
    autorestart=%(ENV_HORIZON_RESTART)s
    user=supervisoruser
    redirect_stderr=true
    stdout_logfile=/var/www/html/storage/logs/horizon.log
    stopwaitsecs=3600
[program:yarn-dev]
    process_name=%(program_name)s_%(process_num)02d
    directory=/var/www/html/
    command=yarn dev
    autostart=%(ENV_YARN_DEV_ONSTART)s
    autorestart=%(ENV_YARN_DEV_RESTART)s
    user=root
    redirect_stderr=true
    stdout_logfile=/var/www/html/storage/logs/yarn.log
    stopwaitsecs=3600
